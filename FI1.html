<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Costo Operativo</title>
    <link rel="stylesheet" type="text/css" href="ISI.css">
    <style>
        .container {
            width: 100%;
            max-width: 1200px;
            margin: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
        }
        input[type="text"], input[type="number"], input[type="date"] {
            width: 100%;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div class="container">
        <form name="google-sheet" autocomplete="off" method="post">
            <h3>Costo Operativo</h3>
            <!-- Aquí va el resto de tu formulario y tablas... -->
            <div class="input-list">
                <div class="input-container">
                    <label for="empresa_options">Empresa:</label>
                    <select id="empresa_options" name="empresa_options" class="dropdown">
                        <option value="null">Selecciona una empresa</option>
                        <option value="ISI">ISI</option>
                        <option value="MSC">MSC</option>
                        <option value="BSC">MIC</option>
                        <option value="ISIN">ISIN</option>
                    </select>
                </div>
            <div class="input-list">
                <div class="input-container">
                    <label for="solicita">Cotización</label>
                    <input type="text" id="solicita" name="solicita" placeholder="Cotización">
                </div>
                
                <div class="input-container">
                    <label for="no_gasto">Folio</label>
                    <input type="number" id="no_gasto" name="no_gasto" placeholder="Folio">
                </div> 

                <div class="input-container">
                    <label for="zona_options">Zona:</label>
                    <select id="zona_options" name="zona_options" class="dropdown">
                        <option value="null">Selecciona una zona</option>
                        <option value="GDL">GDL</option>
                        <option value="PUE">PUE</option>
                    </select>
                </div>

                <div class="input-container">
                    <label for="fecha">Fecha</label>
                    <input type="date" id="fecha" name="fecha" placeholder="Introduce fecha....">
                </div>

            </div>      


            <table border="1">

                <tr>
                    <td><b>Cotización antes de IVA</b></td>
                    <td><input type="number" name="input1_row0" /></td> 
                </tr>
                <tr>
                    <td><b>Inversión</b></td>
                    <td><input type="number" name="input2_row0" /></td> 
                </tr>
                <tr>
                    <td><b>Gastos totales</b></td>
                    <td><input type="number" name="input3_row0"/></td> 
                </tr>
                <tr>
                    <td><b>Utilidad antes de IVA (30%)</b></td>
                    <td><input type="number" name="input3_row0"/></td> 
                </tr>
                <tr>
                    <td><b>Resultado de operación</b></td>
                    <td><input type="number" name="input3_row0"/></td> 
                </tr>
            </table>

            </div>
            <p></p>
            <div class="input-list">
                <div class="input-container">
                    <label for="fecha">Notas</label>
                    <input type="text" id="fecha" name="fecha" placeholder="">
                </div>
            </div>
            <p></p>
            <button type="submit" name="Cargar">Cargar</button>
            <button type="reset" class="reset" name="Limpiar">Limpiar</button>

        </form>
    </div>

    <script>
        const scriptURL = "https://docs.google.com/spreadsheets/d/1zvMdQj8Ud3i5o59_VkBGNbBVX5jHe8lO_ZwnhZdfcLU/edit?usp=sharing";
        const form = document.forms['google-sheet'];

        form.addEventListener('submit', e => {
            e.preventDefault();
            fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                .then(response => alert('¡Registro exitoso!'))
                .catch(error => console.error('Error al cargar la información', error.message));
        });

        function addRow() {
            var table = document.getElementById("dynamicTable");
            var row = table.insertRow(-1);
            for (var i = 0; i < 5; i++) { // Ajustado a 5 para incluir la columna "Costo"
                var cell = row.insertCell(i);
                cell.innerHTML = `<input type="text" name="input${i}_row${table.rows.length - 1}" onchange="sumarCostos()" />`;
            }
            sumarCostos(); // Actualiza la suma al agregar una nueva fila
        }

        function removeRow() {
            var table = document.getElementById("dynamicTable");
            var rowCount = table.rows.length;
            if (rowCount > 2) {
                table.deleteRow(-1);
                sumarCostos(); // Actualiza la suma al eliminar una fila
            } else {
                alert('No se puede eliminar la fila inicial.');
            }
        }

        function sumarCostos() {
            var table = document.getElementById("dynamicTable");
            var total = 0;
            for (var i = 1; i < table.rows.length; i++) { // Comienza en 1 para omitir el encabezado
                var costo = table.rows[i].cells[4].getElementsByTagName("input")[0].value;
                total += parseFloat(costo) || 0; // Suma y convierte el valor a número
            }
            document.getElementById("totalMonto").value = total.toFixed(2); // Muestra el total en la tabla "Monto"
        }
    </script>
</body>
</html>
